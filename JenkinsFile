def modules = [:]
pipeline {
    triggers {
        githubPush()
    }
    agent none
    stages {

         stage('unit test') {
                  agent { docker {
                    image 'golang'
                    args '-u root:sudo -v $HOME'
                     }
                    }

                    when {
                                    branch 'develop'
                         }

                   steps {



                         }
               }
        stage('build') {
           agent { label 'slave2' }


            steps {

                                   script {

                                           sh 'whoami'
                                           sh 'export KUBECONFIG=/home/ec2-user/config'
                                           sh 'echo $KUBECONFIG'
                                           sh 'cat /home/ec2-user/config'
                                           sh '/usr/local/bin/helm list'
                                            }
                                           }
                  }

        }
      }
    }

